
/*-------------------------------------------------------------
    进程线程支持函数
    
    修改时间列表:
    2011-02-26 22:21:22 
-------------------------------------------------------------*/


#include    "ke.h"
#include    "proto.h"


/*-------------------------------------------------------------
-------------------------------------------------------------*/
/*-----------------------------------------------------------*/





/*-------------------------------------------------------------
    根据ID在 PspCidTable表中查找对象
-------------------------------------------------------------*/

pvoid
_stdcall
PsLookupProcessThreadById(
    ulong   ProcessThreadId
    )
{
    pvoid   Object;
    
    if (ProcessThreadId >= (CID_TABLE_SIZE / 4))
    {
        KiBugCheck("PsLookupProcessThreadById: invalid ID\n");
    }
    
    Object = (pvoid)(PspCidTable[ProcessThreadId]);
    
    return Object;
}
/*-----------------------------------------------------------*/



/*-------------------------------------------------------------
-------------------------------------------------------------*/

PKTHREAD
_stdcall
PsGetCurrentThread()
{
    return PsCurrentThread;
}
/*-----------------------------------------------------------*/



/*-------------------------------------------------------------
-------------------------------------------------------------*/

PKPROCESS
_stdcall
PsGetCurrentProcess()
{
    return PsCurrentThread->Process;
}
/*-----------------------------------------------------------*/



/*-------------------------------------------------------------
-------------------------------------------------------------*/

ulong
_stdcall
PsGetCurrentThreadId()
{
    return PsCurrentThread->Tid;
}
/*-----------------------------------------------------------*/



/*-------------------------------------------------------------
-------------------------------------------------------------*/

ulong
_stdcall
PsGetCurrentProcessId()
{
    return PsCurrentThread->Process->Pid;
}
/*-----------------------------------------------------------*/



/*-------------------------------------------------------------
-------------------------------------------------------------*/

ulong
_stdcall
PsGetCurrentTaskId()
{
    return PsCurrentThread->TaskId;
}
/*-----------------------------------------------------------*/
















